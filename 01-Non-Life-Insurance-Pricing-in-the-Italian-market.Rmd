---
output:
  bookdown::pdf_document2:
    template: templates/brief_template.tex
  bookdown::word_document2: default
  bookdown::html_document2: default
documentclass: book
bibliography: references.bib
---

```{r echo=FALSE}
library(knitr)
```

<!-- <!-- Needed for leaving space to the quote, * is for no indentation after title --> -->

<!-- \titlespacing*{\chapter}{0pt}{80px}{35pt} -->

# **Non-Life Insurance Pricing** {#chap:nlip-ita-market}
\minitoc  <!--this will include a mini table of contents-->

\chaptermark{Non-Life Insurance Pricing}

In this chapter I am going to provide an overview on how non-life insurance works from an actuarial point of view with a specific focus on the pricing process.


## What a Non-Life Insurance is {#chap:non-life-ins}

The Italian Civil Code provides the following definition of insurance contract:

```{definition, ins-contr, name = "Insurance Contract, Art. 1882, Italian Civil Code"}
The insurance is the contract with which an insurer, in exchange of the payment of a certain premium, obliged himself, within the agreed limits:
\setlist{nolistsep}
\begin{enumerate}[noitemsep]
  \item to pay an indemnity to the insured equivalent to the damage caused by an accident;
  \item or to pay an income or a capital if a life-related event occurs.
\end{enumerate}
```

This definition identifies two parties: the _Insurer_ and the _Policyholder_. The policyholder pays to the Insurer a certain _Premium_ at the beginning of the insurance coverage and the insurer will pay a benefit if a certain event (_Claim_) occurs. This event could happen zero, one or more than one times, so it is possible to have more than one claim.

Usually, in non-life insurance, the benefit is the payment of a sum. This sum could be predetermined (e.g. in motor theft insurance, where the benefit is usually the value of the insured vehicle) or defined by the entity of the claim (e.g. in motor third party liability insurance, it depends on the damage the policyholder has provided to a third party). Regarding the "agreed limits", another peculiarity of non-life insurances is that the coverage period is defined as a fixed amount of time, usually corresponding to 1 year.

Starting from this legal definition, we can formalize a non-life insurance contract as follows.

Let's:

* $\left]t_1, t_2\right]$, with $t_1<t_2$, be the coverage period;
* $P>0$ be the premium payed by the policyholder to the insurer;
* $N\in\mathbb{N}$ be the number of claims occurred during the coverage period (_claims count_);
* $\tau_1, \tau_2, \dots, \tau_N$, with $t_1<\tau_1< \tau_2 < \dots < \tau_N<t_2$, be the timing of each claim;
* $Z_1, Z_2, \dots, Z_N > 0$ be the amount of each claim (_claims severities_ or _claims sizes_).

The total cost of claims for the insurance is:
$$
S = 
\begin{cases}
  0                    & \text{if } N=0 \\
  \sum_{i=1}^{N}{Z_i}  & \text{if } N>0
\end{cases}
$$
For semplicity, in the following we are going to just use the notation $S = \sum_{i=1}^{N}{Z_i}$ with the meaning of $0$ if $N=0$.

Figure \@ref(fig:ins-cashflow) shows the cash flows corresponding to the insurance contract. From this representation we can interpret the entering into an insurance contract by the policyholder as a way to exchange the negative cash flows $-Z_1, -Z_2, \dots, -Z_N$ with one single negative cash flow $-P$. On the other hand, the insurer undertakes the negative cash flows $-Z_1, -Z_2, \dots, -Z_N$ in exchange for a positive cash flow $+P$.

The major difference between these cash flows is that $P$ is a certain amount, while $Z_1, Z_2, \dots, Z_N$, at the time $t_1$, are uncertain in the amount, in the count ($N$) and in the timing ($\tau_1, \tau_2, \dots, \tau_N$). So, the policyholder, paying a premium $P$, is giving his risk to the insurer.

This representation points out the inversion of the production cycle typical of the insurance activity. From the insurer point of view, the revenue emerges at the beginning of the economic activity, in $t_1$, while the costs will emerge later. In most of other economic activities, the costs emerge before the selling of the product, so the agent can choose the selling price taking into account how much that product costed him. In insurance activity, the insurer, when is selling his product (the insurance coverage), doesn't know the amount of costs he is going to pay for that product. Thus, it is crucial to properly estimate the future costs and determine an adequate premium.

From a statistical point of view, we can translate this uncertainty saying that $N$ and $Z_1, Z_2, \dots, Z_N$ are random variables. Therefore, we can say that $\left\{N, Z_1, Z_2, \dots \right\}$ is a stochastic process. Usually, in non-file insurance pricing, the variables $\tau_1, \tau_2, \dots, \tau_N$ are not taken into account because the coverage span is short and from a financial point of view the timing of the claims occurrences is negligible.

Previously we said that $Z_1, Z_2, \dots, Z_N$ are all $>0$. This assumption corresponds to the fact that we are excluding the null claims, i.e. the claims that have been opened, but result in no payment due by the insurer. For the values of $Z_i$ with $N<i$ we can use the rule that $\{N<i\} \Rightarrow \{Z_i = 0\}$, so $Z_{N+1}=0, \, Z_{N+2}=0, \, \dots$. Therefore, we can say that:
$$
\{N<i \} \Longleftrightarrow \{Z_i = 0\}
$$

```{tikz, ins-cashflow, fig.cap = "Insurance Contract cash flows.", fig.ext = 'pdf', cache = TRUE, echo = FALSE}
\newcommand{\ImageWidth}{11cm}
\usetikzlibrary{decorations.pathreplacing, positioning, arrows.meta}

\begin{tikzpicture}
    % draw horizontal line   
    \draw[thick, -Triangle] (0, 0) -- (\ImageWidth, 0) node[font = \scriptsize, below left = 3pt and -8pt]{$t$};
    \draw[very thick] (1cm, 0) -- (9cm, 0);


    % draw vertical lines and times
    \draw (1cm, -3pt) -- (1cm, 3pt) node[anchor = south] {$t_{1}$};
    \draw (9cm, -3pt) -- (9cm, 3pt) node[anchor = south] {$t_{2}$};

    \draw (2.5cm, -3pt) -- (2.5cm, 3pt) node[anchor = south] {$\tau_{1}$};
    \draw (3.5cm, -3pt) -- (3.5cm, 3pt) node[anchor = south] {$\tau_{2}$};

    \path (5.15cm, -3pt) -- (5.15cm, 3pt) node[anchor = south] {$\dots$};

    \draw (6.8cm, -3pt) -- (6.8cm, 3pt) node[anchor = south] {$\tau_{N-1}$};
    \draw (8.0cm, -3pt) -- (8.0cm, 3pt) node[anchor = south] {$\tau_{N}$};


    % draw Policyholder cash flows
    \node at (-1cm, -14pt) {Policyholder};
    \node at (1cm, -14pt) {$-P$};


    % draw Insurer cash flows
    \node at (-1cm, -28pt) {Insurer};
    \node at (1cm, -28pt) {$P$};

    \node at (2.5cm, -28pt) {$-Z_1$};
    \node at (3.5cm, -28pt) {$-Z_2$};

    \node at (6.8cm, -28pt) {$-Z_{N-1}$};
    \node at (8.0cm, -28pt) {$-Z_N$};

    % \foreach \x in {0, 1, ..., 10}
    %     \draw (\x cm, -3pt) -- (\x cm, 3pt)
    %     node[anchor = south] {$t_{\x}$}
    % ;  
  ;

\end{tikzpicture}
```



## Non-Life insurance pricing

In insurances, the premium that the the insurer offers to the policyholder in exchange for the insurance coverage is not the same for every policyholder. The insurer evaluates the risk related to that policy and determine a "proper" premium taking into account risk related factors and commercial related factors. The process of _pricing_ corresponds in defining the set of rules for determining this "proper" premium $P_i$ for a specific policyholder $i$, given the known information on him. In the next sections I am going to better explain what "proper" means.


### Compound distribution hypotheses

The first step for evaluating the stochastic process $\left\{N, Z_1, Z_2, \dots \right\}$ is to introduce some probabilistic hypotheses. The usual hypotheses assumed are the following:

```{definition, comp-dist, name = "Compound distribution"}

Let's assume that:

1. for each $n>0$, the variables $Z_1|N=n,\ Z_2|N=n,\ \dots,\ Z_n|N=n$ are stochastically independent and identically distributed;
2. the probability distribution of $Z_i|N=n, \ i\le n$ does not depend on $n$.

Under these hypotheses we say that:
$$
S = \sum_{i=1}^{N}{Z_i}
$$
has a compound distribution.
```

The variable $Z_i|N=n$ used in this definition can be interpreted as the _claim severity for the $i$^th^ claim under the hypothesis that $n$ claims occurred_. The two hypotheses provided in definition \@ref(def:comp-dist) imply that the distribution of $Z_i|N=n, \ i<n$ does not depend from $i$ nor from $n$. For this reason, in the following, we are going to use the notation $Z$ to represent a random variable with the $Z_i|N=n, \ i<n$ distribution and $F_Z(\cdot)$ for its cumulative distribution function (i.e. $F_Z(z) = P(Z\le z)$).

Let's consider the variabile $Z_i|N>i$. We can interpret it as the _claim severity for the $i$^th^ claim under the hypothesis that the $i$^th^ claim occurred_. From the hypotheses provided in definition \@ref(def:comp-dist) we can obtain that also $Z_i|N>i$ has the same distribution of $Z_i|N=n, \ i<n$. This can be easily obtained as follows:


```{=latex}
\begin{eqnarray}
\label{eq:z1}
P\left(Z_i \middle| N\ge i \right) & = & P\left(Z_i \middle| \bigvee_{n = i}^{+\infty}{(N=n)}\right)
\ = \\ \label{eq:z2} & = &
\sum_{n=i}^{+\infty}{ \underbrace{P\left(Z_i\le z \middle| N=n\right)}_{=F_Z(z)} P\left( N = n \middle| N\ge i \right)}
\ = \\ \label{eq:z3} & = &
\sum_{n=i}^{+\infty}{ F_Z(z) P\left( N = n \middle| N\ge i \right)}
\ = \\ \label{eq:z4} & = &
F_Z(z) \underbrace{\sum_{n=i}^{+\infty}{P\left( N = n \middle| N\ge i \right)}}_{=1}
\ = \\ \nonumber & = &
F_Z(z)
\end{eqnarray}
```

Where:

* the step \@ref(eq:z1) and the step \@ref(eq:z2) are given by the fact that the event $\{N\ge i\}$ can be decomposed as $\{N\ge i\} = \left\{ \bigvee_{n = i}^{+\infty}{(N=n)} \right\}$ and that the events $\{N=n\}, n\in\{i, i+1, i+2, \dots\}$ are two-by-two disjoint, so they constitute a partition of $\{N\ge i\}$, that allows us to use the disintegrability property of the probability;
* the step \@ref(eq:z3) is due to the fact that the distribution of $Z_i\le z | N=n$ depends neither on $i$ nor on $n$;
* the equivalence $\sum_{n=i}^{+\infty}{P\left( N = n \middle| N\ge i \right)} = 1$ at step \@ref(eq:z4) is due to the fact that the events $\{N=n\}, n\in\{i, i+1, i+2, \dots\}$ are a partition of $\{N\ge i\}$.

Therefore, $Z$ can be considered as the _claim severity for a claim under the hypothesis that that claim occurred_.


### Distribution of the total cost of claims {#tcc-dist}

Under the hypotheses defined in definition \@ref(def:comp-dist), it is possible to obtain the full distribution of $S$ given the distribution of $N$ and $Z$. In this chapter we are going to provide only the formula of the expected value $E(S)$, but, with the same approach one can obtain all the moments.

The expected value of the total cost of claims $E(S)$ can be obtained from the expected value of the claims count $E(N)$ and the expected value of the claim severity $E(Z)$ as follows:

```{=latex}
\begin{eqnarray}
\label{eq:s1}
E(S) & = & \sum_{n=0}^{+\infty}{P(N=n) \, E\left(S \middle| N = n \right)}
\ = \\ \label{eq:s2} & = &
\sum_{n=0}^{+\infty}{P(N=n) \, E\left(\sum_{i=1}^{n}{Z_i} \middle| N = n \right)}
\ = \\ \label{eq:s3} & = &
\sum_{n=0}^{+\infty}{P(N=n) \sum_{i=1}^{n}{\underbrace{E\left( Z_i \middle| N = n \right)}_{=E(Z)}}}
\ = \\ \label{eq:s4} & = &
\sum_{n=0}^{+\infty}{P(N=n) n E(Z)}
\ = \\ \label{eq:s5} & = &
E(Z) \underbrace{\sum_{n=0}^{+\infty}{n P(N=n)}}_{=E(N)}
\ = \\ \label{eq:s6} & = &
E(N)E(Z)
\end{eqnarray}
```

Where:

* the step \@ref(eq:s1) is given by the fact that the events $\{N=0\}, \{N=1\}, \{N=2\}, \dots$ constitute a partition of the certain event $\Omega$, that allows us to use the disintegrability property of the expected value;
* the step \@ref(eq:s2) is due to the definition of $S$;
* the step \@ref(eq:s3) is due to the linearity of the expected value;
* the steps \@ref(eq:s4) and \@ref(eq:s5) are due to the fact that, as assumed by the compound distribution hypotheses, $E\left( Z_i \middle| N = n \right)$ does not depends on $i$ and $n$;
* the step \@ref(eq:s6) is due to the definition of the expected value $E(N)=\sum_{n=0}^{+\infty}{n P(N=n)}$.

This result tells us that, under the hypotheses of the compound distribution, it is possible to easily obtain $E(S)$ from $E(N)$ and $E(Z)$. That means that we can model separately $E(N)$ and $E(Z)$ and, from them, obtain $E(S)$. That result is particularly useful in personalization (paragraph \@ref(chap:personalization)), because, for each individual $i$, given the information we have on him $x_i=(x_{i1},  x_{i2}, \dots, x_{ip})$, we can estimate his expected claim size $E(N_i)$ and his expected claim severity $E(Z_i)$ and obtain his expected total cost of claims as $E(S_i) = E(N_i) E(Z_i)$.



### Risk premium and Technical Price

The expected cost of claims $E(S)$ is important because it gives us a first interpretation of what "proper" premium means.

```{definition, risk-premium, name = "Risk Premium"}
Said $S$ the total cost of claims of a policyholder, his _Risk Premium_ is given by:
$$
P^{(risk)} = E(S)
$$
```

The _Risk Premium_ is the premium that on average covers the total cost of claims. As mentioned above, as the coverage spans are usually short, we are not taking into account the timing of the claims and we don't discount the fact that the claims occur later than the premium payment.

It is clear that this premium, that only covers the cost of claims, is not "proper" in the practice. 

First of all, the insurer has to cover also the expenses related to the policy (commission on sales and expenses related to the claim settlement) and the general expenses of the company. Adding the expenses, we obtain the _Technical Price_.

```{definition, technical-price, name = "Technical Price"}
Said $S$ the total cost of claims of a policyholder and $E$ the expenses related to his policy, his _Technical Price_ is given by:
$$
P^{(tech)} \ = \ E(S) + E \ = \ P^{(risk)} + E
$$
```

Secondly, even if the policyholder would pay a premium that on average covers claims and expenses, undertaking that risk with nothing in return would not make sense for the insurer. So, to the Technical Price, a loading must be added. This loading can be justified as a loading for the risk or as a profit loading.

The result of the Technical Price with these loadings can be further modified based on business logic, as I am going to discuss later.


## Modeling and Personalization {#chap:personalization}

<!--
Often the insurance premium for a specific policyholder $i$ is represented as the product of a reference premium $P$ and a relative coefficient $\alpha_i$ as follows:
$$
P_i = \alpha_i P
$$
The coefficient $\alpha_i$ and the reference premium $P$ can be estimated separately. The process of defining the function for obtaining $\alpha_i$ is called personalization.
-->

In this section We are going to better explain how pricing based on policyholder information works.


### Pricing variables

Usually for every policyholder we have a certain amount of information on him that is considered relevant for his risk evaluation. This information must be reliable and observable at the moment of the underwriting of the policy.

In motor insurances, this information could be:

* Information on the insured vehicle: make, model, engine power, vehicle mass, age of the vehicle;
* General information of the policyholder: age, sex, address (region, city, postcode), ownership of a private box where he parks the car;
* Insurance specific information of the policyholder: number of claims caused in the previous years, how long he has been covered, bonus-malus class;
* Policy options: amount of the maximum coverage, presence and amount of a deductible, presence of other insurance guarantees, how many drivers will drive the vehicle;
* Customer information on the policyholder: how many years he has been a customer of the insurer, how many other policies he owns.
* Telematic data: how many kilometers per year the policyholder travelled in the previous years, how many sharp accelerations and decelerations per kilometer the policyholder performed in the previous years.

These pieces of information are usually called _pricing variables_.

We must observe that some of these variables are available for every potential customer (such as his age and address), while others are only available for policyholder that are already customers (such as telematic data that is available only if the policyholder agreed on installing on their car the device that collects this data).

Moreover, even considering the variables that are available for every customer, it is important to be aware on how reliable they are. Some of them comes from official documents (as customer age and address or bonus-malus class), but others could be declared by the customer and his statements are not easily verifiable by the insurer (as the ownership of a private box or how many drivers will drive the vehicle).

This topic of variables reliability fits in the wider framework of fraud detection. Insurance companies put a lot of effort in preventing frauds. This is done with active actions, such as documents checks and inspections, and with predictive fraud detections models. The two most common categories of frauds are underwriting frauds (such as false declaration on insurance related data) and settlement frauds (such as faking an accident). The customer information on the policyholder is usually important to predict both underwriting frauds and settlement frauds. Usually customers that have a longer relationship with the company and own many policies are less likely to commit frauds.

Regarding the topic of variables reliability, the Italian Insurance Associations ([ANIA](https://www.ania.it/)) in the last years made some big steps forward by collecting in its databases a lot of information about policyholders and vehicles and making it available to insurance companies. For example, by logging in these databases it is possible, at the moment of the quote request, to retrieve useful insurance specific information such as the number of claims caused by the customer in the previous years or how long he has been covered and useful information on his vehicle such as when it has been registered or how many changes of ownership did it experienced.

One of the roles of the actuary is to understand how reliable the information on the policyholder is and to decide how to use that information.


### Pricing variables encoding

Formally the pricing variables can be encoded as a vector of real numbers. $\boldsymbol{x}_i=(x_{i1}, x_{i2}, \dots, x_{ip})\in\mathcal{X}\subseteq\mathbb{R}^p$. In the modeling framework they can be also called explanatory variables, covariates, predictors or features.

The pricing variables can be of two types:

1. _Quantitative variables_: variables, like policyholder age or vehicle mass, that can be easily represented as a number;
2. _Qualitative variables_: variables, like policyholder sex or vehicle make, that represent a category and are usually represented with strings.

The quantitative variables, with eventual transformations, are already suitable to be used.

To facilitate the use of the qualitative variables, they are usually encoded as sets of binary variables.

If a variable $x$ has only 2 possible modalities, it can be easily encoded in a binary variable $z$ that assigns $0$ to one modality and $1$ to the other. For example, if $x = \text{sex}$, it can be encoded this way:
$$
z = \begin{cases}
1 & \text{if } \text{sex } = \text{ `Male'} \\
0 & \text{if } \text{sex } = \text{ `Female'}
\end{cases}
$$

In general, if a variable $x$ has $K$ modalities, it can be encoded in $K-1$ binary variables $z_1, z_2, \dots, z_{K-1}$. For example, if $x = \text{make}$ and it can have 4 possible modalities ('Fiat', 'Alfa-Romeo', 'Lancia', 'Ferrari') it can be encoded this way:

```{=latex}
\begin{align*}
z_1 & = \begin{cases}
1 & \text{if } \text{make } = \text{ `Fiat'} \\
0 & \text{otherwise} \\
\end{cases}
\\
z_2 & = \begin{cases}
1 & \text{if } \text{make } = \text{ `Alfa-Romeo'} \\
0 & \text{otherwise} \\
\end{cases}
\\
z_3 & = \begin{cases}
1 & \text{if } \text{make } = \text{ `Lancia'} \\
0 & \text{otherwise} \\
\end{cases}
\\
\end{align*}
```

The variables $z_1$, $z_2$, $z_3$ are called dummy variables. We can observe that all the information about the make is embedded in just these 3 variables, so a fourth dummy variable that indicate the modality 'Ferrari' is not needed. Indeed:

$$
\text{make } = \text{`Ferrari'} \ \Longleftrightarrow \ z_1=z_2=z_3=0
$$
In table \@ref(tab:dummy-variables) the dummy variable encoding is illustrated.

```{r, dummy-variables-table, echo = FALSE}
table <- tibble(
  make = c("Fiat", "Alfa-Romeo", "Lancia", "Ferrari"),
  z1 = c(1, 0, 0, 0),
  z2 = c(0, 1, 0, 0),
  z3 = c(0, 0, 1, 0)
)

table %>% 
  kable(
    # format = "latex",
    booktabs = T,
    align = "lrrr",
    vline = "",
    toprule = "", midrule = "\\hline",
    linesep = "", bottomrule = "",
    caption = "Dummy variables encoding.",
    label = "dummy-variables"
  ) %>% 
  kable_styling(
    position = "center",
    latex_options = "hold_position",
    full_width = FALSE
  )
```

For some models it is suggested to use also the dummy variable that indicates the $K$^th^ modality. This encoding is called one-hot encoding and it is mainly used in Neural Networks. For the models considered in this paper it is preferred the $K-1$ dummy variables encoding, so we will always consider it.

In the following, when I use the notation $\boldsymbol{x}_i=(x_{i1}, x_{i2}, \dots, x_{ip})$, I'll always consider that the qualitative variables have been already encoded as dummy variables, so $(x_{i1}, x_{i2}, \dots, x_{ip})\in \mathcal{X} \subseteq \mathbb{R}^p$


### Pricing Rule and Modeling

The pricing variables are used as input of a _Pricing Rule_.

```{definition, pricing-rule, name = "Pricing Rule"}
A _Pricing Rule_ is a function $f(\cdot)$ that from an instance of a set of pricing variables $\boldsymbol{x}_i\in\mathcal{X}$ returns a price:

$$  
\begin{array}{rccl}
f: & \mathcal{X}      & \longrightarrow  & R_+ \\
   & \boldsymbol{x}_i & \longmapsto      & P_i \\
\end{array}
$$
```

The process of pricing consists in defining a Pricing Rule based on observed data from the past and assumptions on the future.

The first step for defining a Pricing Rule is to model the total cost of claims $S$ and obtain a pricing rule for the risk premium $P^{(risk)}$.

In general, in this context, modeling a _response variable_ $Y$ means finding a function $r:\mathcal{X}\rightarrow \mathcal{C}$ that, given a set of explanatory variables $\boldsymbol{x}_i=(x_{i1}, x_{i2}, \dots, x_{ip})\in \mathcal{X} \subseteq \mathbb{R}^p$, returns the expected value of the response variable $E(Y)$ and eventually other moments of $Y$ or even the full distribution of $Y$. I used a generic $\mathcal{C}$ as codomain of the function $r(\cdot)$ to not specify whether in the model describe just $E(Y)$ (and so $\mathcal{C}=\mathbb{R}$) or something more, such as the couple $\left( E(S), Var(S) \right)$ or the full distribution of $S$.

As we observed in section \@ref(tcc-dist), under the compound distribution hypotheses, it is not needed to model directly the total cost of claims $S$, but we can separately model $N$ and $Z$.


### Response variables and distribution

Usually in statistical modeling, the response variables are seen as random variables with a distribution belonging to a specified family.


#### Distribution for the claims count $N$

The claim count $N$ is a discrete variable with determination in $\{0, 1, 2, 3,\dots\}$. Even if in practice the number of claims can't be arbitrarily high, the claim count is usually modeled with distributions that give a positive probability to all the numbers in its support. One of the most common distribution used for $N$ is the Poisson distribution.

```{definition, def-poisson, name = "Poisson Distribution"}
A random variable $N$ with support $\{0,1,2,3,\dots \}$ has a Poisson distribution, if its probability function is:
$$
p_N(n) = P\left( N = n \right) = e^{-\lambda}\frac{\lambda^n}{n!}, \quad \lambda>0
$$
We will indicate it with the notation $N \sim Poisson(\lambda)$.
```

```{r, plot-poisson, echo = FALSE, fig.cap = "Poisson distribution for some values of $\\lambda$.", fig.align = "center", fig.width = 6, fig.height = 3}
tibble(x = 0:22) %>% 
  crossing(
    tibble(
      lambda = c(.8, 1, 2.5, 10)
    )
  ) %>% 
  mutate(
    y = dpois(x = x, lambda = lambda),
    lambda_label = str_c("lambda = ", lambda) %>% 
      fct_inorder()
  ) %>% 
  ggplot(aes(x = x, y = y)) +
  geom_point() +
  geom_segment(
    aes(xend = x),
    yend = 0
  ) +
  facet_wrap(~lambda_label) +
  coord_cartesian(
    xlim = c(0, 20)
  ) +
  labs(
    x = "n", y = "p(n)"
  )
```

The Poisson distribution is a parametric distribution that depends on only the parameter $\lambda$. In figure \@ref(fig:plot-poisson), for different levels of $\lambda$ the distribution is represented. These plots show how increasing for larger values of $\lambda$, the distribution is shifted to larger values and it is wider.

Indeed, the first two moments are:

```{=latex}
\begin{align*}
E(N)   & = \lambda \\
Var(N) & = \lambda
\end{align*}
```

Thus, increasing $\lambda$, both $E(N)$ and $Var(N)$ increase.

Looking to the distribution shape, we can see that:

* if $\lambda<1$, the mode is in $n=0$;
* if $\lambda=1$, $p(0)=p(1)=\frac{1}{e}$;
* if $\lambda>1$, the mode is in a value greater than $0$ and, as $\lambda$ increases, the distribution assume a bell shape similar to the Normal distribution one.

In non-life insurance we usually are in the case with $\lambda<1$. E.g. the average number of claims for motor third party liability insurances in Italy, in 2018 has been 5.68%^[[ANIA yearly statistical report for motor third party liability](https://www.ania.it/ricerca-avanzata/-/asset_publisher/XIyLeujL9irt/content/id/113283)].

The property $Var(N) = E(N)$ is an important constraint when the distribution is used in practice. It is possible that the observed data shows a different pattern. Often the observed data shows a situation where $Var(N) > E(N)$. This phenomenon is called overdispesion.

To address this issue it is possible to use more flexible distributions, such as Negative-Binomial distribution, or to adopt less assumptions on the response variable distribution. One common technique is the assumption of Quasi-Poisson distribution, that we will describe in chapter \@ref(chap:models).


#### Exposure

In section \@ref(chap:non-life-ins) we said that non-life insurances usually have a fixed coverage period the usually spans for one year. Often we work with portfolios of insurances with different coverage periods. For example, this could be due to the presence of insurances born with shorter coverage periods or the presence of insurances that has been closed earlier. Moreover, in companies data, often insurance data are collected for accounting years. This means that, if an insurance coverage $c$ spans in two consecutive years $a$ and $a+1$, it is collected as two records: the couple $(c, a)$ and the couple $(c, a+1)$. This situation is quite common, as usually coverages start in the middle of the year and not at the first of the year.

The coverage span for an insurance coverage is called _exposure_ and it is usually measured in years-at-risk. For instance, if an insurance coverage spans for 3 months, it corresponds to a quarter of year, so the exposure, measured in years-at-risk, is $v=\frac{1}{4}$. The term year-at-risk comes from the fact that the policyholder exposure is a risk for the insurer, so the exposure is the period in which the insurer is exposed to the risk of paying claims.

It is natural to assume that, if a policyholder has a longer exposure, it is expected for him to experience more claims. Considered that we have to work with policies with different exposures, in order to take this aspect into account, the usual assumption taken in the following. Said $M$ the number of claims the policyholder will experience during his period of exposure $v$ and $N$ the number of claims the policyholder would experience during one year, we assume $E(M) = v E(N)$.

This assumption can be further extended if we assume that the claims come from a _Poisson process_.









<!-- 
Poisson distribution
- Definition
- Properties
- Other distributions
- Quasi-Poisson

Exposure (years-at-risk)
Poisson process

-->





#### Distribution for the claims size $Z$

```{definition, def-gamma, name = "Gamma Distribution"}
A random variable $Z$ with support $[0, +\infty[$ has a Gamma distribution, if its probability density function is:
$$
f_Z(z) = \frac{\rho^\alpha}{\Gamma(\alpha)}z^{\alpha-1}e^{-\rho z}, \quad \alpha > 0, \ \rho > 0
$$
We will indicate it with the notation $Z \sim Gamma(\alpha, \rho)$.
```


```{r, plot-gamma, echo = FALSE, fig.cap = "Gamma distribution for some values of $\\alpha$ and $\\rho$.", fig.align = "center", fig.width = 6, fig.height = 3}
tibble(x = seq(from = 0, to = 25, by = .01)) %>% 
  crossing(
    tibble(
      alpha = c(.8, 1, 2, 16),
      rho = c(.2, .25, .5, 2)
    )
  ) %>% 
  mutate(
    y = dgamma(x = x, shape = alpha, rate = rho),
    label = str_c("alpha = ", alpha, ", rho = ", rho) %>% 
      fct_inorder()
  ) %>% 
  ggplot(aes(x = x, y = y)) +
  geom_line() +
  facet_wrap(~label) +
  coord_cartesian(
    ylim = c(0, .3),
    xlim = c(0, 20)
  ) +
  labs(
    x = "z", y = "f(z)"
  )

```




<!-- 
Gamma distribution
- Definition
- Properties
- Large claims
  + Gamma light tails
  + Other distributions
  + excess, propensity
- Binomial distribution

Exposure (years-at-risk)
Poisson process

-->




<!--
Qua devo spiegare
- Distribuzioni
  + Distribuzione di Poisson
  + Distribuzione Gamma
    * Sinistri punta: eccedenze, modello di propensity
  + Distribuzione Binomiale
  Appendice: Distribuzioni, momenti...
- Dati a disposizione: osservazioni di queste variabili aleatorie
-->



### Model fitting and data available

<!--
Consolidamento dei sinistri
Pagato + Riservato
IBNYR
IBNER

Convoluzione

Sistema CARD
-->





<!-- In this context, the variables $N$ and $Z$ are called _response variables_. -->

We will discuss some of the most widespread models for claims count and claims severity in chapter \@ref(chap:models).











### Data available





<!--
- Distribuzione variabile risposta
- Dati a disposizione
-->


\newpage

## Non-Life Insurance in Italy

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus id mauris interdum, malesuada ante eu, tempus lacus. Aliquam blandit tortor a velit ultricies, eget pharetra nulla egestas. Suspendisse pellentesque finibus est, vitae ullamcorper magna convallis ut. Nulla a lectus in ligula iaculis convallis. Pellentesque tortor mauris, tempor nec dictum et, facilisis sit amet dolor. Mauris nibh quam, molestie non ex quis, hendrerit dignissim nulla. Aliquam sit amet dui at diam vestibulum malesuada a id lacus. Phasellus viverra orci vitae sem pretium, eu consequat libero euismod.

Cras suscipit aliquam consequat. Quisque sodales lacus ac erat malesuada, eu laoreet enim vestibulum. Sed id ante id ligula auctor ullamcorper. Sed luctus rutrum mollis. Vestibulum sed ultrices quam. Duis id orci ut enim elementum maximus id quis justo. Pellentesque rutrum ligula in aliquam rhoncus. Integer suscipit nisl at mi efficitur interdum. Aenean et orci elit.

Nam ultricies est et iaculis tempus. Quisque leo lorem, sagittis et ligula a, blandit mattis velit. Phasellus pretium, orci et semper finibus, dui nulla tempor nisl, vel vehicula magna diam nec sem. Praesent finibus commodo enim non laoreet. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur ut pellentesque purus. Proin hendrerit, odio vel sodales porta, ex lorem feugiat sem, non fringilla libero ex ac ligula. Quisque facilisis eros at suscipit rhoncus.


## The actuary role

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus id mauris interdum, malesuada ante eu, tempus lacus. Aliquam blandit tortor a velit ultricies, eget pharetra nulla egestas. Suspendisse pellentesque finibus est, vitae ullamcorper magna convallis ut. Nulla a lectus in ligula iaculis convallis. Pellentesque tortor mauris, tempor nec dictum et, facilisis sit amet dolor. Mauris nibh quam, molestie non ex quis, hendrerit dignissim nulla. Aliquam sit amet dui at diam vestibulum malesuada a id lacus. Phasellus viverra orci vitae sem pretium, eu consequat libero euismod.

Cras suscipit aliquam consequat. Quisque sodales lacus ac erat malesuada, eu laoreet enim vestibulum. Sed id ante id ligula auctor ullamcorper. Sed luctus rutrum mollis. Vestibulum sed ultrices quam. Duis id orci ut enim elementum maximus id quis justo. Pellentesque rutrum ligula in aliquam rhoncus. Integer suscipit nisl at mi efficitur interdum. Aenean et orci elit.

Nam ultricies est et iaculis tempus. Quisque leo lorem, sagittis et ligula a, blandit mattis velit. Phasellus pretium, orci et semper finibus, dui nulla tempor nisl, vel vehicula magna diam nec sem. Praesent finibus commodo enim non laoreet. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur ut pellentesque purus. Proin hendrerit, odio vel sodales porta, ex lorem feugiat sem, non fringilla libero ex ac ligula. Quisque facilisis eros at suscipit rhoncus.

Questa è una citazione [@Shea2014; @Lottridge2012]

<!-- \nocite{*} -->

<!-- \titlespacing{\chapter}{0pt}{0pt}{35pt} -->

